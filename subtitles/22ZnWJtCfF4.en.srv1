<?xml version="1.0" encoding="utf-8" ?><transcript><text start="0" dur="5.91">my talk is about flashing ECU firmware</text><text start="3.899" dur="3.96">updates from a web browser more</text><text start="5.91" dur="5.22">specifically I did some reverse</text><text start="7.859" dur="5.94">engineering of the Honda firmware update</text><text start="11.13" dur="5.43">file format that they put out so that&amp;#39;s</text><text start="13.799" dur="6.121">when were you talking about so Who am I</text><text start="16.56" dur="6.27">my name is greg hogan you can follow me</text><text start="19.92" dur="4.08">on twitter all the source code for the</text><text start="22.83" dur="2.699">software that i&amp;#39;m going to show you is</text><text start="24" dur="5.189">open-source you can find it in one or</text><text start="25.529" dur="6.511">more my github repositories and I work</text><text start="29.189" dur="4.71">at common AI on infrastructure which yes</text><text start="32.04" dur="4.2">you&amp;#39;re wondering that has nothing to do</text><text start="33.899" dur="7.221">with car hacking</text><text start="36.24" dur="8.07">so a couple days ago I got an email and</text><text start="41.12" dur="6.52">it&amp;#39;s a DEFCON 27 talk and I thought oh</text><text start="44.31" dur="6.87">this is information on like my speaking</text><text start="47.64" dur="6.15">gig here I opened up the email and no it</text><text start="51.18" dur="5.67">is from Honda so apparently they were</text><text start="53.79" dur="5.64">interested in my talk and I&amp;#39;ll summarize</text><text start="56.85" dur="5.88">this for you it basically says don&amp;#39;t do</text><text start="59.43" dur="6.3">something that might kill somebody that</text><text start="62.73" dur="4.77">was never my intention I won&amp;#39;t be for</text><text start="65.73" dur="4.47">some reason they thought that I was</text><text start="67.5" dur="4.95">probably going to be releasing specific</text><text start="70.2" dur="4.62">modifications about making firmware</text><text start="72.45" dur="5.01">modifications to power steering</text><text start="74.82" dur="5.13">controllers of Honda vehicles that&amp;#39;s not</text><text start="77.46" dur="4.11">the case I never planned on talking</text><text start="79.95" dur="2.88">about anything like that so that doesn&amp;#39;t</text><text start="81.57" dur="3.9">change anything that I&amp;#39;m going to be</text><text start="82.83" dur="5.64">talking about also this is a completely</text><text start="85.47" dur="4.14">legitimate thing to ask of someone to</text><text start="88.47" dur="3.36">make sure you don&amp;#39;t do something that</text><text start="89.61" dur="4.86">could injure somebody and I agree</text><text start="91.83" dur="3.899">completely that trying to make changes</text><text start="94.47" dur="3.57">to your electronic power steering</text><text start="95.729" dur="5.64">firmware of your car could be very</text><text start="98.04" dur="5.91">dangerous if you screw something up the</text><text start="101.369" dur="4.651">best case might be that the steering</text><text start="103.95" dur="4.29">wheel tries to break your arms and the</text><text start="106.02" dur="5.459">worst case is it&amp;#39;ll flip over your car</text><text start="108.24" dur="6">and kill you so please don&amp;#39;t do anything</text><text start="111.479" dur="4.53">stupid and I have no intention of</text><text start="114.24" dur="3.71">enabling you to be able to do such</text><text start="116.009" dur="4.941">things</text><text start="117.95" dur="7.919">what got me interested in flashing ECU</text><text start="120.95" dur="7.41">firmware updates so in 2017 George Hotz</text><text start="125.869" dur="4.291">he&amp;#39;s actually the guy that started the</text><text start="128.36" dur="4.5">company that I worked for he gave a talk</text><text start="130.16" dur="4.71">at code blue at a conference where he</text><text start="132.86" dur="3.75">kind of showed some you kind of showed</text><text start="134.87" dur="2.97">some information about like how you can</text><text start="136.61" dur="3.989">get these firmware updates from</text><text start="137.84" dur="4.11">different vehicle manufacturers and I</text><text start="140.599" dur="3.36">looked at these tools that he was</text><text start="141.95" dur="5.429">showing and I thought wow that&amp;#39;s</text><text start="143.959" dur="6.481">software&amp;#39;s garbage it looks like it runs</text><text start="147.379" dur="7.08">on like Windows XP and why isn&amp;#39;t anyone</text><text start="150.44" dur="7.49">created anything better so that&amp;#39;s kind</text><text start="154.459" dur="3.471">of what I what I set out to do</text><text start="160.21" dur="4.56">and I guess to to do that to enable that</text><text start="163" dur="4.2">in like a modern web development stack</text><text start="164.77" dur="4.8">that&amp;#39;s why I decided to see if I could</text><text start="167.2" dur="4.44">make this work where I could flesh ECU&amp;#39;s</text><text start="169.57" dur="5.13">from web browsers</text><text start="171.64" dur="4.44">it&amp;#39;s basically what I&amp;#39;m going to show</text><text start="174.7" dur="2.67">you how to do is basically similar to</text><text start="176.08" dur="3.36">what like there so there&amp;#39;s a whole</text><text start="177.37" dur="4.74">community of people who go out there and</text><text start="179.44" dur="4.41">they make changes to do like engine</text><text start="182.11" dur="3.29">tuning for their ECU&amp;#39;s change like gas</text><text start="183.85" dur="3.99">fuel mixtures and stuff like that</text><text start="185.4" dur="4.33">they&amp;#39;ve basically done what I&amp;#39;m going to</text><text start="187.84" dur="5.31">show you they&amp;#39;ve figured out you know</text><text start="189.73" dur="4.77">how the firmware updates work for in</text><text start="193.15" dur="3.69">what I&amp;#39;m going to show you here Honda</text><text start="194.5" dur="4.5">vehicles and then they figure out how to</text><text start="196.84" dur="4.5">flash their own firmware updates</text><text start="199" dur="6.05">essentially without using the Honda</text><text start="201.34" dur="3.71">software to do so that they distribute</text><text start="209.72" dur="6.87">so how do you get the software and</text><text start="213.74" dur="6.36">firmware updates for these vehicles so</text><text start="216.59" dur="5.91">thanks to write to repair vehicle</text><text start="220.1" dur="5.19">manufacturers are basically required to</text><text start="222.5" dur="5.55">provide at a reasonable cost the</text><text start="225.29" dur="5.94">firmware updates for the tools basically</text><text start="228.05" dur="6.39">that enable any maintenance shop to be</text><text start="231.23" dur="5.1">able to do repair work so that you&amp;#39;re</text><text start="234.44" dur="3.9">not like locked into going to a holiday</text><text start="236.33" dur="3.21">dealership and them like charging you</text><text start="238.34" dur="5.91">and I&amp;#39;m gonna like to do this kind of</text><text start="239.54" dur="8.01">stuff so anyone can sign up for these</text><text start="244.25" dur="5.51">these these websites Honda is really</text><text start="247.55" dur="4.74">cheap ten dollars for one day to</text><text start="249.76" dur="7.33">download the software that they provide</text><text start="252.29" dur="7.62">to their you know to their repair shops</text><text start="257.09" dur="4.98">and anyone who&amp;#39;s like you know a repair</text><text start="259.91" dur="4.5">shop that repairs Honda vehicles they&amp;#39;ll</text><text start="262.07" dur="4.08">you know subscribe to this also if you</text><text start="264.41" dur="6.45">subscribe for one day interestingly you</text><text start="266.15" dur="5.79">actually get three days so Toyota&amp;#39;s a</text><text start="270.86" dur="3.45">little more expensive and you know</text><text start="271.94" dur="3.99">there&amp;#39;s other vehicle manufactures well</text><text start="274.31" dur="3.12">I guess just one that does like over the</text><text start="275.93" dur="3.12">year updates and you don&amp;#39;t have you you</text><text start="277.43" dur="3.18">know if you have the right access to</text><text start="279.05" dur="3.18">your car the firmware updates are</text><text start="280.61" dur="5.63">actually pushed to your vehicle so you</text><text start="282.23" dur="4.01">don&amp;#39;t have to like pay to get them</text><text start="286.32" dur="8.04">so so I signed up and I downloaded the</text><text start="290.97" dur="5.85">software and I wish I could get that</text><text start="294.36" dur="6.27">four hours of my life back that it took</text><text start="296.82" dur="5.43">to install it it&amp;#39;s horrible just like</text><text start="300.63" dur="5.22">from a UI perspective usability</text><text start="302.25" dur="5.7">perspective it&amp;#39;s not great software the</text><text start="305.85" dur="4.74">authentication is over HTTP</text><text start="307.95" dur="4.08">like nobody&amp;#39;s proud of themselves for</text><text start="310.59" dur="4.59">like working on the software I don&amp;#39;t</text><text start="312.03" dur="6.54">think this is the new version this is</text><text start="315.18" dur="5.7">new for like I think like 2017 model</text><text start="318.57" dur="4.38">year vehicles or something like that the</text><text start="320.88" dur="4.11">old version looked even sadder</text><text start="322.95" dur="5.01">it&amp;#39;s called HDS Honda for Honda its</text><text start="324.99" dur="4.8">Honda Diagnostics system in 2017 when</text><text start="327.96" dur="3.63">this new version came out they threw an</text><text start="329.79" dur="3.36">eye in the front of it my guess is</text><text start="331.59" dur="3.72">they&amp;#39;re like trying to ride the Apple</text><text start="333.15" dur="5.49">train you know bandwagon or something</text><text start="335.31" dur="5.82">like I Oh s and so forth but using this</text><text start="338.64" dur="5.43">software is nothing like using an Apple</text><text start="341.13" dur="4.38">product you also need a piece of</text><text start="344.07" dur="5.19">hardware to interface with the car</text><text start="345.51" dur="5.85">through the ODB to port so that hardware</text><text start="349.26" dur="5.57">there&amp;#39;s if you go to the Honda website</text><text start="351.36" dur="6.66">there&amp;#39;s one there&amp;#39;s one like certified</text><text start="354.83" dur="6.15">Hardware package that you can buy and it</text><text start="358.02" dur="6.24">is almost $1,500</text><text start="360.98" dur="4.69">sad because like it just does like stuff</text><text start="364.26" dur="3.15">that follows specifications that are</text><text start="365.67" dur="6.5">open you know that anyone can implement</text><text start="367.41" dur="4.76">because of right to repair basically</text><text start="372.74" dur="6.21">so one of those boxes on like that first</text><text start="376.19" dur="6.9">window was something called the J the J</text><text start="378.95" dur="6.24">2 v 3 for rewrite tool so what is that</text><text start="383.09" dur="4.77">thing that&amp;#39;s the software that actually</text><text start="385.19" dur="7.08">does the firmware updates that actually</text><text start="387.86" dur="6.96">flashes your ECU&amp;#39;s so the company I work</text><text start="392.27" dur="5.72">for they actually make an obd2 dongle</text><text start="394.82" dur="6.75">that has a USB port called a panda and</text><text start="397.99" dur="6.3">it&amp;#39;s a lot cheaper than $1,500 product</text><text start="401.57" dur="6.36">that Honda sells it has an open-source</text><text start="404.29" dur="7.27">j2 534 driver which is basically the API</text><text start="407.93" dur="5.01">that that like the whatever for like</text><text start="411.56" dur="3.45">emissions testing and so forth they</text><text start="412.94" dur="6.63">defined it so that you know to enable</text><text start="415.01" dur="6.42">write to repair essentially and the</text><text start="419.57" dur="6.42">driver like it&amp;#39;s not perfect but it&amp;#39;ll</text><text start="421.43" dur="6.48">East works for can and so so I decided</text><text start="425.99" dur="5.43">to go down this path since it&amp;#39;s so much</text><text start="427.91" dur="5.97">more cost-effective and the Panda has it</text><text start="431.42" dur="5.55">has a great Python library for</text><text start="433.88" dur="7.11">interacting with your vehicle over the</text><text start="436.97" dur="6.9">obd2 port and someone wrote a web USB</text><text start="440.99" dur="4.65">driver for it so I&amp;#39;ll get into that a</text><text start="443.87" dur="4.47">little bit more but that&amp;#39;s a big part of</text><text start="445.64" dur="5.69">what enables me being able to flash an</text><text start="448.34" dur="2.99">ECU from a web browser</text><text start="451.34" dur="3.51">so that four hours that I spend</text><text start="453.23" dur="3.96">installing the software on a really fast</text><text start="454.85" dur="5.67">machine another thing that it drops</text><text start="457.19" dur="5.729">alongside this executable is the actual</text><text start="460.52" dur="5.149">firmware updates so that&amp;#39;s how you get</text><text start="462.919" dur="4.591">the actual firmware update files and</text><text start="465.669" dur="4.441">they&amp;#39;re in this folder here that I</text><text start="467.51" dur="2.6">listed button</text><text start="471.23" dur="5.22">so okay now we&amp;#39;ve got a flashing tool</text><text start="473.66" dur="5.91">and we&amp;#39;ve got firmware updates so now</text><text start="476.45" dur="4.8">what we want to do is we want to reverse</text><text start="479.57" dur="4.41">engineer you know whatever the process</text><text start="481.25" dur="4.53">is so that I can replicate it and build</text><text start="483.98" dur="5.55">my own software that actually does this</text><text start="485.78" dur="7.34">so the first thing that I found was this</text><text start="489.53" dur="7.68">software called J 2 v 3 for lager</text><text start="493.12" dur="9.19">basically what that does is it acts as a</text><text start="497.21" dur="8.04">proxy to a real j2 5:34 driver the the J</text><text start="502.31" dur="4.95">2 v 3 4 spec so the reason part of the</text><text start="505.25" dur="3.84">reason that this software I did guess I</text><text start="507.26" dur="4.47">didn&amp;#39;t mention this this Honda software</text><text start="509.09" dur="4.86">it only runs on Windows and the reason</text><text start="511.73" dur="6.68">that it only runs on Windows is because</text><text start="513.95" dur="8.58">the j2 5:34 API specifies things like</text><text start="518.41" dur="8.89">use these registry keys to find a dll</text><text start="522.53" dur="6.53">and load it so that&amp;#39;s another reason</text><text start="527.3" dur="4.44">that I was interested in creating my own</text><text start="529.06" dur="4.09">software that flashes this because you</text><text start="531.74" dur="2.58">know if you break out of that you can</text><text start="533.15" dur="2.58">you know make something that&amp;#39;s like</text><text start="534.32" dur="3.38">cross-platform there runs on a web</text><text start="535.73" dur="5.15">browser which should be cool</text><text start="537.7" dur="5.28">so basically you can you can fire up</text><text start="540.88" dur="6.42">that j2 five three four rewrite tool the</text><text start="542.98" dur="7.02">Honda puts out and fire up this install</text><text start="547.3" dur="5.07">this logger and if you have a vehicle</text><text start="550" dur="4.44">that has an ECU that has an update you</text><text start="552.37" dur="4.89">can apply it yourself with this software</text><text start="554.44" dur="5.55">and you can record it and it&amp;#39;ll dump out</text><text start="557.26" dur="6.09">this big log file that has all the j2</text><text start="559.99" dur="5.82">534 API calls as well as like the raw</text><text start="563.35" dur="6.03">data that was sent and received back and</text><text start="565.81" dur="6.39">forth so then to you know kind of dig</text><text start="569.38" dur="6.42">deeper into what the actual steps are</text><text start="572.2" dur="5.759">that happened when you flash a honda ECU</text><text start="575.8" dur="4.37">firmware update we need to start</text><text start="577.959" dur="5.521">understanding some of these other specs</text><text start="580.17" dur="6.07">UDS unified Dinan gnostics that&amp;#39;s like a</text><text start="583.48" dur="5.49">big one it has all the like commands</text><text start="586.24" dur="5.4">that j2 534 uses to actually communicate</text><text start="588.97" dur="4.17">with ECU make it feel like security</text><text start="591.64" dur="4.889">access key exchange and all these things</text><text start="593.14" dur="5.759">and send the firmware the next layer</text><text start="596.529" dur="3.961">down is is OTP I mention we just</text><text start="598.899" dur="3.781">mentioning these things because this is</text><text start="600.49" dur="3.86">what I have to implement if I&amp;#39;m going to</text><text start="602.68" dur="6.75">implement my own and a web browser</text><text start="604.35" dur="9.479">because as far as I know no one has</text><text start="609.43" dur="4.399">written one in JavaScript</text><text start="616.3" dur="8.28">all right so after recording flashing an</text><text start="620.41" dur="6.24">ECU from that j25 3/4 rewrite tool that</text><text start="624.58" dur="6.33">honda distributes here&amp;#39;s what you come</text><text start="626.65" dur="8.07">up with basically more or less an</text><text start="630.91" dur="5.34">eight-step process here the first thing</text><text start="634.72" dur="3.57">that you have to do is you have to these</text><text start="636.25" dur="4.8">are all the names on the right are the</text><text start="638.29" dur="4.44">UDS message types essentially that you</text><text start="641.05" dur="9.09">have to send to communicate with your</text><text start="642.73" dur="8.79">car so basically you need to enter you</text><text start="650.14" dur="4.47">need to send a session control message</text><text start="651.52" dur="5.94">because you can&amp;#39;t you can&amp;#39;t request a</text><text start="654.61" dur="4.74">security access seed until you&amp;#39;ve gotten</text><text start="657.46" dur="3.99">into that specific diagnostic session</text><text start="659.35" dur="5.67">mode once you get there you can request</text><text start="661.45" dur="5.96">a seed you&amp;#39;ll then see you&amp;#39;ll then see</text><text start="665.02" dur="4.86">the seed go back to the software</text><text start="667.41" dur="5.2">software then does a manipulation to</text><text start="669.88" dur="5.25">that seed sends back a key and that key</text><text start="672.61" dur="5.37">is what allows you to do the next step</text><text start="675.13" dur="4.2">which is enter a programming session so</text><text start="677.98" dur="2.61">this is what we want to get to right we</text><text start="679.33" dur="2.76">want to be able to we want to get the</text><text start="680.59" dur="5.19">ECU to the state where we can actually</text><text start="682.09" dur="7.09">send and change the firmware on it</text><text start="685.78" dur="5.91">then things get dangerous like from a oh</text><text start="689.18" dur="4.5">crap I might brick my ECU perspective</text><text start="691.69" dur="4.9">because the next thing that you do is</text><text start="693.68" dur="7.44">you erase the memory that you want to</text><text start="696.59" dur="6.57">write after you erase it you you have to</text><text start="701.12" dur="3.51">send this message that is it turns out</text><text start="703.16" dur="6.33">what it is is you&amp;#39;re sending it some</text><text start="704.63" dur="6.63">some keys that go to the firmware so</text><text start="709.49" dur="3.6">that it can decrypt the firmware that</text><text start="711.26" dur="3.66">you&amp;#39;re going to send it so it turns out</text><text start="713.09" dur="4.44">that these Honda firmware update files</text><text start="714.92" dur="7.95">the firmware portion of the file</text><text start="717.53" dur="8.19">they actually encrypted and the ajaita</text><text start="722.87" dur="4.89">5:3 for rewrite tool it doesn&amp;#39;t decrypt</text><text start="725.72" dur="4.79">it it sends it to the ECU and then the</text><text start="727.76" dur="6.18">ECU decrypt it so they haven&amp;#39;t</text><text start="730.51" dur="6.37">distributed per se any software that you</text><text start="733.94" dur="5.49">can obtain that actually has like the</text><text start="736.88" dur="4.64">the decryption algorithm in it it&amp;#39;s all</text><text start="739.43" dur="4.13">needs to you</text><text start="741.52" dur="4.92">then you you know proceeded to send the</text><text start="743.56" dur="4.92">firmware and then at the very end it</text><text start="746.44" dur="3.84">does basically checksum you send a</text><text start="748.48" dur="3.12">message that performs this validation</text><text start="750.28" dur="3.3">which I believe what it does is</text><text start="751.6" dur="4.5">validates that the check sums in the</text><text start="753.58" dur="5.07">firmware correct the check sums in the</text><text start="756.1" dur="5.7">Honda firmware extremely poor they&amp;#39;re</text><text start="758.65" dur="6.78">actually just the sum of all the bytes</text><text start="761.8" dur="5.49">across a few sections so so I don&amp;#39;t know</text><text start="765.43" dur="5.64">like that&amp;#39;s kind of crappy a bit you</text><text start="767.29" dur="5.19">know a couple bit flips and and yeah you</text><text start="771.07" dur="4.28">might have might have you might not have</text><text start="772.48" dur="2.87">what you thought you had there</text><text start="776.79" dur="5.04">all right so this firmware update file I</text><text start="780.42" dur="3.75">mentioned earlier on that there&amp;#39;s a</text><text start="781.83" dur="3.9">folder that gets dropped that has all</text><text start="784.17" dur="4.65">these firmware update files in it and</text><text start="785.73" dur="5.19">those firmware update files have a</text><text start="788.82" dur="4.71">certain format that I&amp;#39;m now going to go</text><text start="790.92" dur="4.68">through and explain you know what the</text><text start="793.53" dur="5.16">different pieces are because my ultimate</text><text start="795.6" dur="5.34">goal here is to create a website that I</text><text start="798.69" dur="6.45">choose one of these firmware update</text><text start="800.94" dur="6.87">files and I then flash it to an ECU as</text><text start="805.14" dur="4.95">if I you know was that j2 five three</text><text start="807.81" dur="6.75">four rewrite tool but without any Honda</text><text start="810.09" dur="7.11">any software written by Honda so the</text><text start="814.56" dur="4.8">very first bite of the file is what I</text><text start="817.2" dur="3.63">call the signature it basically tells</text><text start="819.36" dur="3.51">you the format of the rest of the file</text><text start="820.83" dur="3.69">there&amp;#39;s a few different formats I&amp;#39;m just</text><text start="822.87" dur="4.05">gonna focus on one because I only care</text><text start="824.52" dur="4.23">about one which is can there&amp;#39;s also</text><text start="826.92" dur="3.9">other formats I think where like you</text><text start="828.75" dur="4.37">flash over Lin or other other protocols</text><text start="830.82" dur="4.92">but I&amp;#39;m just gonna focus on can because</text><text start="833.12" dur="6.33">that&amp;#39;s probably like the future at least</text><text start="835.74" dur="7.61">for any vehicle that I&amp;#39;m going to own</text><text start="839.45" dur="7.63">SOCAN is this in this hex 5a about you</text><text start="843.35" dur="5.86">all right so now the next section after</text><text start="847.08" dur="5.34">that first bite now we&amp;#39;re in the cans</text><text start="849.21" dur="6.51">specific format of the firmware update</text><text start="852.42" dur="7.05">and there&amp;#39;s six header fields these six</text><text start="855.72" dur="7.47">header fields they basically have</text><text start="859.47" dur="6.45">everything that you need to be able to</text><text start="863.19" dur="6.48">look at one of these firmware update</text><text start="865.92" dur="7.77">files determine if the car that you&amp;#39;re</text><text start="869.67" dur="7.35">plugged into has an ECU that a specific</text><text start="873.69" dur="7.68">firmware update file applies to and if</text><text start="877.02" dur="9.84">it&amp;#39;s running a version of firmware that</text><text start="881.37" dur="7.38">is supported as an update or if the file</text><text start="886.86" dur="6.54">is an update for the version of the</text><text start="888.75" dur="6.51">firmware that&amp;#39;s on the ECU so you only</text><text start="893.4" dur="3.87">need a few things you need the can</text><text start="895.26" dur="4.26">address of the ECU that you want to know</text><text start="897.27" dur="3.92">if you can update with the specific</text><text start="899.52" dur="3.57">firmware filed so there&amp;#39;s one byte that</text><text start="901.19" dur="3.31">specifies it the reason it&amp;#39;s a single</text><text start="903.09" dur="3.78">byte is because like if you look at the</text><text start="904.5" dur="5.31">spec 29 bit addresses there&amp;#39;s only one</text><text start="906.87" dur="8.1">significant byte so they just have that</text><text start="909.81" dur="7.11">one byte in there and then there&amp;#39;s a few</text><text start="914.97" dur="4.83">different values like they can change</text><text start="916.92" dur="5.28">these security access keys per firmware</text><text start="919.8" dur="5.969">update file so they put the actual keys</text><text start="922.2" dur="5.34">in the firmware update file</text><text start="925.769" dur="3.6">because you have to send them to the ECU</text><text start="927.54" dur="6.599">so when the ECU receives the firmware it</text><text start="929.369" dur="8.01">knows how to decrypt it and then there&amp;#39;s</text><text start="934.139" dur="6.87">also a key that I&amp;#39;ll get into in a</text><text start="937.379" dur="6.15">minute here that is an input to the</text><text start="941.009" dur="5.73">security access key exchange so what you</text><text start="943.529" dur="6.92">need to do to get that ECU into</text><text start="946.739" dur="3.71">programming mode essentially</text><text start="951.98" dur="5.44">after the headers is the actual firmware</text><text start="955.74" dur="4.71">this is the encrypted firmware that I</text><text start="957.42" dur="7.11">talked about before there&amp;#39;s a start</text><text start="960.45" dur="6">address in a length when you that</text><text start="964.53" dur="4.8">sequence that I laid out a couple of the</text><text start="966.45" dur="5.61">steps were saying okay what section of</text><text start="969.33" dur="5.52">firm word do I want to flash on the ECU</text><text start="972.06" dur="5.43">and how much data am I now going to send</text><text start="974.85" dur="3.84">that&amp;#39;s part of that UDS sequence of</text><text start="977.49" dur="4.86">messages that you have to send to the</text><text start="978.69" dur="5.7">ECU it the the honda ECU&amp;#39;s i&amp;#39;ve looked</text><text start="982.35" dur="5.85">at they actually only allow you to flash</text><text start="984.39" dur="6.45">one section of the firmware they did a</text><text start="988.2" dur="4.59">pretty good job in terms of like making</text><text start="990.84" dur="5.16">it kind of hard to brick the device</text><text start="992.79" dur="5.75">because the bootloader is outside of the</text><text start="996" dur="7.32">area that they allow you to flash so</text><text start="998.54" dur="7.18">that&amp;#39;s good but yeah the state is</text><text start="1003.32" dur="5.24">encrypted so we can&amp;#39;t really look at the</text><text start="1005.72" dur="2.84">firmware at this point</text><text start="1008.62" dur="4.89">and then at the end of the file is a</text><text start="1011.86" dur="5.7">checksum and it&amp;#39;s just the sum of all</text><text start="1013.51" dur="7.32">the bytes except the checksum itself and</text><text start="1017.56" dur="6.84">so that is that&amp;#39;s the entirety of one of</text><text start="1020.83" dur="8.66">these can format honda firmware update</text><text start="1024.4" dur="8.4">files all right the encryption so I</text><text start="1029.49" dur="5.08">mentioned that this firmware is like the</text><text start="1032.8" dur="4.83">data section of the update file for the</text><text start="1034.57" dur="4.92">firmware is encrypted so I thought ok</text><text start="1037.63" dur="5.61">well in the interesting to see if we can</text><text start="1039.49" dur="4.92">decrypt that and the talk that I</text><text start="1043.24" dur="2.79">mentioned at the beginning that got me</text><text start="1044.41" dur="6.21">kind of interested in this George&amp;#39;s code</text><text start="1046.03" dur="8.04">blue talked he shows one algorithm that</text><text start="1050.62" dur="5.1">they used for encryption and I thought</text><text start="1054.07" dur="3.42">to myself oh ok well maybe I&amp;#39;m lucky</text><text start="1055.72" dur="3.96">maybe they use the same encryption for</text><text start="1057.49" dur="4.92">every one of these updates it turns out</text><text start="1059.68" dur="5.67">that&amp;#39;s not the case but there was these</text><text start="1062.41" dur="5.63">keys that we already found in the</text><text start="1065.35" dur="6.54">headers of each firmware update file so</text><text start="1068.04" dur="5.44">I&amp;#39;ve got the keys I&amp;#39;ve got an example so</text><text start="1071.89" dur="4.139">what should I try ok well maybe they</text><text start="1073.48" dur="5.789">just change the operators</text><text start="1076.029" dur="6.72">it turns out at least somewhat common</text><text start="1079.269" dur="6.36">that&amp;#39;s the case and it&amp;#39;s not too hard to</text><text start="1082.749" dur="5.43">write a piece of software in Python that</text><text start="1085.629" dur="7.8">just brute force tries every combination</text><text start="1088.179" dur="8.761">of operators that result in a full 256</text><text start="1093.429" dur="4.891">value lookup table where every value is</text><text start="1096.94" dur="4.739">you know the input is unique to the</text><text start="1098.32" dur="5.01">output so utilizing that I wrote this</text><text start="1101.679" dur="4.62">piece of software that I linked to it</text><text start="1103.33" dur="6.149">that&amp;#39;s out there called RWD x-ray and</text><text start="1106.299" dur="5.43">that it does that exactly it it&amp;#39;ll you</text><text start="1109.479" dur="5.67">give it a firmware update file and it</text><text start="1111.729" dur="6.33">will try to find it&amp;#39;ll try to find a set</text><text start="1115.149" dur="5.94">of operators based on the keys in the</text><text start="1118.059" dur="5.6">RWD file to be able to decrypt the</text><text start="1121.089" dur="2.57">firmware</text><text start="1126.05" dur="4.8">yeah so that&amp;#39;s really fast most these</text><text start="1129.05" dur="3.9">firmware updates are small and yeah it</text><text start="1130.85" dur="4.95">takes like seconds to to run this</text><text start="1132.95" dur="4.41">through and find the find the</text><text start="1135.8" dur="2.76">appropriate operators for a lot of them</text><text start="1137.36" dur="2.31">doesn&amp;#39;t seem to work on all of them</text><text start="1138.56" dur="2.91">which makes me think that maybe they</text><text start="1139.67" dur="3.84">actually use like a different algorithm</text><text start="1141.47" dur="3.18">for some firmware updates but it seems</text><text start="1143.51" dur="3.57">like there&amp;#39;s a number of them that they</text><text start="1144.65" dur="5.45">actually use the same basic algorithm</text><text start="1147.08" dur="3.02">with just different operators</text><text start="1152.2" dur="6.4">so this is just an example of running</text><text start="1156.59" dur="3.42">that tool it just kind of it ties</text><text start="1158.6" dur="4.23">everything together that I just talked</text><text start="1160.01" dur="7.05">through it basically you know parses the</text><text start="1162.83" dur="6.84">file spits out the headers the way that</text><text start="1167.06" dur="7.05">it figures out if it has successfully</text><text start="1169.67" dur="7.35">decrypted the firmware is that there&amp;#39;s a</text><text start="1174.11" dur="5.61">UDS message that you can send to request</text><text start="1177.02" dur="5.55">the software version of an ECU to get</text><text start="1179.72" dur="5.91">the firmware version of an ECU that</text><text start="1182.57" dur="6.54">returns something that looks like a part</text><text start="1185.63" dur="5.6">number for Honda with an extra little</text><text start="1189.11" dur="6.18">bit of an extra few numbers at the end</text><text start="1191.23" dur="8.26">all of these RWD files have a name</text><text start="1195.29" dur="7.41">that looks like a part number so what I</text><text start="1199.49" dur="7.35">do is I take the beginning portion of</text><text start="1202.7" dur="7.59">the RWD file and I say every time I try</text><text start="1206.84" dur="7.77">a set of operators do I find in the</text><text start="1210.29" dur="8.94">decrypted firmware a string that matches</text><text start="1214.61" dur="6.03">that and normally there&amp;#39;s just one down</text><text start="1219.23" dur="3.42">the bottom there all those dots is it</text><text start="1220.64" dur="5.19">trying every possible set of operators</text><text start="1222.65" dur="6.33">that existed and the X means it hit and</text><text start="1225.83" dur="5.64">it actually found the string that it was</text><text start="1228.98" dur="4.5">looking for in this brute force way of</text><text start="1231.47" dur="4.79">going through the different</text><text start="1233.48" dur="5.079">possibilities of all the algorithms</text><text start="1236.26" dur="4.19">[Music]</text><text start="1238.559" dur="5.511">and then it spits out the decrypted</text><text start="1240.45" dur="3.62">firmware into a file at the end</text><text start="1244.27" dur="7.14">okay so my goal here is to flash an ECU</text><text start="1248.86" dur="4.5">from a web browser and I now completely</text><text start="1251.41" dur="5.19">understand this firmware update file</text><text start="1253.36" dur="5.79">that honda has that honda publishes that</text><text start="1256.6" dur="5.37">anyone can get ahold of it has</text><text start="1259.15" dur="5.07">everything in it I guess except the</text><text start="1261.97" dur="4.35">actual security access key exchange</text><text start="1264.22" dur="4.35">algorithm so I know I figured out</text><text start="1266.32" dur="4.65">everything I need to figure out to flash</text><text start="1268.57" dur="3.989">an ECU myself you know write my own</text><text start="1270.97" dur="2.67">software that does it but I don&amp;#39;t know</text><text start="1272.559" dur="4.291">how to make it through the security</text><text start="1273.64" dur="7.14">access key exchange their security</text><text start="1276.85" dur="8.01">access key changes okay it it generates</text><text start="1280.78" dur="5.91">a random two byte number and then you</text><text start="1284.86" dur="4.47">have to manipulate it and send back the</text><text start="1286.69" dur="4.95">corresponding response that is the</text><text start="1289.33" dur="4.32">correct response going you know after</text><text start="1291.64" dur="4.35">you manipulate it with security access</text><text start="1293.65" dur="4.86">key exchange algorithm but we don&amp;#39;t know</text><text start="1295.99" dur="5.58">what that is so a brute force would take</text><text start="1298.51" dur="5.34">a long time it&amp;#39;s probably actually maybe</text><text start="1301.57" dur="4.82">doable but if you do it you&amp;#39;ve now</text><text start="1303.85" dur="6.27">figured it out for one ECU for</text><text start="1306.39" dur="7.36">potentially one single firmware revision</text><text start="1310.12" dur="5.64">of that ECU so what else would have this</text><text start="1313.75" dur="4.31">security access key exchange that I</text><text start="1315.76" dur="5.89">already have access to</text><text start="1318.06" dur="7.02">well how about that j25 3/4 reflash tool</text><text start="1321.65" dur="5.89">turns out it&amp;#39;s pretty easy to find the</text><text start="1325.08" dur="5.97">security access key extraño algorithm in</text><text start="1327.54" dur="6.26">that tool and it looks like as far as I</text><text start="1331.05" dur="6.96">can tell they basically use the same</text><text start="1333.8" dur="6.93">algorithm to a similarly simple</text><text start="1338.01" dur="8.67">algorithm just you know addition</text><text start="1340.73" dur="7.75">multiplication and modulo so basically</text><text start="1346.68" dur="3.9">the same algorithm there&amp;#39;s just like one</text><text start="1348.48" dur="4.89">variation whether the whether the key</text><text start="1350.58" dur="7.77">that&amp;#39;s in the file is 2 or what 4 bytes</text><text start="1353.37" dur="7.02">or 6 bytes and so yeah great now we</text><text start="1358.35" dur="5.25">found how to get through the security</text><text start="1360.39" dur="5.79">access key exchange for probably any</text><text start="1363.6" dur="6.33">honda ECU at least that his flash Dover</text><text start="1366.18" dur="5.85">can most likely and I guess like all the</text><text start="1369.93" dur="4.29">people that do like the engine tuning</text><text start="1372.03" dur="4.14">ECU tuning I guess they all know this I</text><text start="1374.22" dur="4.14">don&amp;#39;t know I guess it was easy to find</text><text start="1376.17" dur="4.4">though so I guess it makes sense that</text><text start="1378.36" dur="2.21">they would</text><text start="1380.8" dur="5.88">all right so I&amp;#39;ve got everything I want</text><text start="1384.31" dur="4.83">or I need to know now to build this</text><text start="1386.68" dur="6.32">website so I created this website it&amp;#39;s</text><text start="1389.14" dur="8.7">open source auto ECU dot IO is the URL</text><text start="1393" dur="9.34">it&amp;#39;s the auto ECU github repository that</text><text start="1397.84" dur="8.21">I have it&amp;#39;s open source it&amp;#39;s it only</text><text start="1402.34" dur="6.69">supports this Panda ODB 2 dongle that</text><text start="1406.05" dur="6.76">that I&amp;#39;m using here because I don&amp;#39;t know</text><text start="1409.03" dur="8.34">any other any other ODB - dongle that</text><text start="1412.81" dur="6.36">supports the web USB driver that Chrome</text><text start="1417.37" dur="5.09">has so that you can interact with a USB</text><text start="1419.17" dur="5.97">device directly from from a web browser</text><text start="1422.46" dur="4.45">this website is just static content like</text><text start="1425.14" dur="4.59">you don&amp;#39;t need an internet connection to</text><text start="1426.91" dur="4.83">use it there&amp;#39;s no API you can don&amp;#39;t you</text><text start="1429.73" dur="4.98">can totally just pull down the github</text><text start="1431.74" dur="4.56">repo and run it locally but you know for</text><text start="1434.71" dur="4.61">convenience I just threw it up on auto</text><text start="1436.3" dur="3.02">ECU IO</text><text start="1439.76" dur="3.4">[Music]</text><text start="1441.18" dur="4.14">there are some problems it&amp;#39;s not perfect</text><text start="1443.16" dur="4.32">now this isn&amp;#39;t like productionize code</text><text start="1445.32" dur="3.99">so don&amp;#39;t use it on something that you&amp;#39;re</text><text start="1447.48" dur="4.47">not willing to replace if you end up</text><text start="1449.31" dur="7.86">breaking your ECU I actually opened a</text><text start="1451.95" dur="8.49">chrome a chrome issue because in their</text><text start="1457.17" dur="5.61">effort to curb people doing crypto</text><text start="1460.44" dur="4.65">mining in your web browsers like through</text><text start="1462.78" dur="4.62">ads and so forth they don&amp;#39;t let tabs</text><text start="1465.09" dur="5.31">that are like in the background or don&amp;#39;t</text><text start="1467.4" dur="5.61">have focus keep executing code</text><text start="1470.4" dur="4.62">indefinitely or maybe they only give it</text><text start="1473.01" dur="3.69">like small time slices or something so</text><text start="1475.02" dur="4.65">like for example when you use this you</text><text start="1476.7" dur="6.69">really want to keep the browser focused</text><text start="1479.67" dur="5.04">because because like you switch tabs and</text><text start="1483.39" dur="3.39">then basically the flashing process</text><text start="1484.71" dur="3.48">applause this so you really don&amp;#39;t want</text><text start="1486.78" dur="5.43">that to happen you know what in the</text><text start="1488.19" dur="6.06">middle generally it&amp;#39;s like it&amp;#39;s okay</text><text start="1492.21" dur="3.9">like if you cancel flashing one of these</text><text start="1494.25" dur="4.11">ECU&amp;#39;s in them in the middle you&amp;#39;ve</text><text start="1496.11" dur="4.32">potentially erased the ECU but since the</text><text start="1498.36" dur="3.48">bootloader is at the beginning if you</text><text start="1500.43" dur="3.09">haven&amp;#39;t done anything really dumb and if</text><text start="1501.84" dur="3.96">you&amp;#39;re not really unlucky you can just</text><text start="1503.52" dur="5.46">you can just cycle the power and start</text><text start="1505.8" dur="4.77">over and flash again but yeah it&amp;#39;s</text><text start="1508.98" dur="6.93">definitely possible that you&amp;#39;ll brick an</text><text start="1510.57" dur="9.15">ECU if you use this so I have a little</text><text start="1515.91" dur="8.85">video here I have a 20-17 honda cr-v it</text><text start="1519.72" dur="7.35">has ECU updates for several ACU&amp;#39;s let&amp;#39;s</text><text start="1524.76" dur="7.98">play this here</text><text start="1527.07" dur="8.37">see if I can make it fullscreen here if</text><text start="1532.74" dur="5.1">you watch the - really close things look</text><text start="1535.44" dur="4.44">pretty good right now it looks normal</text><text start="1537.84" dur="7.47">I&amp;#39;m like picking the firmware file right</text><text start="1539.88" dur="7.02">now does a little validation and then</text><text start="1545.31" dur="6.72">I&amp;#39;m gonna start the flashing process</text><text start="1546.9" dur="10.2">here and then holy every error code</text><text start="1552.03" dur="6.21">possible pops up on the dash so I don&amp;#39;t</text><text start="1557.1" dur="2.76">know if I like miss maybe I missed</text><text start="1558.24" dur="4.26">something maybe there&amp;#39;s like some way to</text><text start="1559.86" dur="4.32">prevent that from happening but it&amp;#39;s</text><text start="1562.5" dur="3.75">kind of scary I mean I tested this like</text><text start="1564.18" dur="4.77">on a bench before and actually like had</text><text start="1566.25" dur="4.71">bugs in my code like for example when</text><text start="1568.95" dur="4.29">you plug when you plug into one ECU</text><text start="1570.96" dur="5.1">sitting on a bench there&amp;#39;s no other</text><text start="1573.24" dur="9.05">ECU&amp;#39;s on the canvas so like you can make</text><text start="1576.06" dur="9.03">a mistake where your software assumes</text><text start="1582.29" dur="5.62">accidentally that there&amp;#39;s only what that</text><text start="1585.09" dur="5.1">every message that&amp;#39;s coming is intended</text><text start="1587.91" dur="3.75">for you know your software when you know</text><text start="1590.19" dur="3.72">the ECU&amp;#39;s are throwing messages all over</text><text start="1591.66" dur="4.14">the place all the time and so luckily</text><text start="1593.91" dur="3.48">that was easy to fix and now now it</text><text start="1595.8" dur="4.83">works better in like actually this</text><text start="1597.39" dur="5.31">successfully flashes the ECU looks like</text><text start="1600.63" dur="3.3">it&amp;#39;s flashing right now actually</text><text start="1602.7" dur="3.69">applying the firmware I think this is</text><text start="1603.93" dur="5.37">like applying the radar firmware update</text><text start="1606.39" dur="5.63">for my car or something like that so</text><text start="1609.3" dur="7.05">I&amp;#39;ve just I just took you know the the</text><text start="1612.02" dur="7.45">RWD file the Honda names these firmware</text><text start="1616.35" dur="5.16">update files but RWD is the extension</text><text start="1619.47" dur="3.51">I just took that you know selected in</text><text start="1621.51" dur="3.45">the software that I&amp;#39;ll show you a live</text><text start="1622.98" dur="5.429">demo here in a minute of an ECU on a</text><text start="1624.96" dur="6.51">bench and picked it and flashed it and</text><text start="1628.409" dur="8.451">then I just power cycled the car and all</text><text start="1631.47" dur="5.39">the ears went away so that&amp;#39;s great work</text><text start="1640.25" dur="5.26">Thanks</text><text start="1641.52" dur="6.539">so so that was fun but you know these</text><text start="1645.51" dur="5.22">these ECU engine tuner guys they don&amp;#39;t</text><text start="1648.059" dur="4.651">just flash the updates that they you</text><text start="1650.73" dur="3.3">know get from Honda they reverse</text><text start="1652.71" dur="4.11">engineered this and they generate their</text><text start="1654.03" dur="4.379">own updates right so wouldn&amp;#39;t it be more</text><text start="1656.82" dur="3.69">fun if we you know we could you know</text><text start="1658.409" dur="3.9">figure out how to generate an update</text><text start="1660.51" dur="7.98">maybe for an ECU that doesn&amp;#39;t even have</text><text start="1662.309" dur="7.261">an update and then flash that so you</text><text start="1668.49" dur="3.03">don&amp;#39;t need a whole lot of information</text><text start="1669.57" dur="5.219">you just need you know whatever is in</text><text start="1671.52" dur="5.19">that RWD file you can just make up some</text><text start="1674.789" dur="3.87">keys you do have to be able to figure</text><text start="1676.71" dur="2.52">out you know how to get firmware off of</text><text start="1678.659" dur="2.64">an ECU</text><text start="1679.23" dur="4.439">maybe or you could like I guess start</text><text start="1681.299" dur="3.721">with one of those our double D files if</text><text start="1683.669" dur="6.211">you wanted to just to play around with</text><text start="1685.02" dur="6.42">generating your own and but you got to</text><text start="1689.88" dur="3.45">be able to get you know the firmware you</text><text start="1691.44" dur="4.5">have to be able to encrypt it since it&amp;#39;s</text><text start="1693.33" dur="4.68">encrypted in these are two BD update</text><text start="1695.94" dur="5.7">files but this is actually like a pretty</text><text start="1698.01" dur="5.73">good format for updating an ECU because</text><text start="1701.64" dur="3.539">it&amp;#39;s like self-contained it&amp;#39;s a</text><text start="1703.74" dur="4.71">self-contained file and it has</text><text start="1705.179" dur="6">everything in it you need to be able to</text><text start="1708.45" dur="5.19">flash an ECU and validate that you know</text><text start="1711.179" dur="5.101">the ECU that you&amp;#39;re going to flash is</text><text start="1713.64" dur="4.769">running you know an expected version of</text><text start="1716.28" dur="5.07">firmware before you flash it and and so</text><text start="1718.409" dur="6.48">forth so so</text><text start="1721.35" dur="6.809">in my RWE x-ray repo there is a script</text><text start="1724.889" dur="5.611">that does just that if you supply it an</text><text start="1728.159" dur="5.341">encrypted firmware file like what you</text><text start="1730.5" dur="6.24">would find in one of the RWD files in</text><text start="1733.5" dur="5.46">the firmware section and the appropriate</text><text start="1736.74" dur="7.169">headers then it&amp;#39;ll kick out for you an</text><text start="1738.96" dur="8.88">are WD file that you can flash using my</text><text start="1743.909" dur="7.051">website alright so let&amp;#39;s do that I have</text><text start="1747.84" dur="7.079">I just just because out of convenience I</text><text start="1750.96" dur="7.469">have an ECU here that I tore apart to</text><text start="1754.919" dur="6.23">play around with and it&amp;#39;s you can get</text><text start="1758.429" dur="6.59">for example a lot of ECU&amp;#39;s on you know</text><text start="1761.149" dur="6.88">like LQK online for really cheap this is</text><text start="1765.019" dur="6.221">specifically an ECU for the electronic</text><text start="1768.029" dur="5.4">power steering for my 2017 Honda CRV I&amp;#39;m</text><text start="1771.24" dur="5.7">just using it because like that&amp;#39;s what I</text><text start="1773.429" dur="5.781">have out of convenience so let&amp;#39;s let&amp;#39;s</text><text start="1776.94" dur="2.27">do it</text><text start="1783.42" dur="4.57">so yeah so basically I just I was it I</text><text start="1786.25" dur="3.99">figured out how to extract the firmware</text><text start="1787.99" dur="5.13">from the CCU I used that are to be</text><text start="1790.24" dur="4.14">builder to what I did was just build you</text><text start="1793.12" dur="3.78">know for proof of concept</text><text start="1794.38" dur="4.53">I built a firmware update that does</text><text start="1796.9" dur="5.22">nothing it literally just is the</text><text start="1798.91" dur="4.98">original firmware on the ECU so that&amp;#39;s</text><text start="1802.12" dur="6.53">we&amp;#39;re gonna do so this is this is my web</text><text start="1803.89" dur="7.17">sorry this is my website auto ECU IO and</text><text start="1808.65" dur="5.43">right now it has to drop down for</text><text start="1811.06" dur="5.79">manufacturer Honda is the only</text><text start="1814.08" dur="4.18">manufacturer that is supported but you</text><text start="1816.85" dur="2.88">know it&amp;#39;s open-source if someone&amp;#39;s</text><text start="1818.26" dur="4.26">interested they could you know</text><text start="1819.73" dur="6.18">definitely add formats of other firmware</text><text start="1822.52" dur="5.7">update files distributed by other car</text><text start="1825.91" dur="4.38">manufacturers I&amp;#39;d looked a little bit I</text><text start="1828.22" dur="4.41">like Tesla&amp;#39;s firmware update file format</text><text start="1830.29" dur="4.08">and it&amp;#39;s like so much simpler than the</text><text start="1832.63" dur="3.12">Honda for example it just has like I</text><text start="1834.37" dur="3.24">think it has like a header that says the</text><text start="1835.75" dur="4.35">start address in the length and then</text><text start="1837.61" dur="4.47">it&amp;#39;s just the firmware just you know not</text><text start="1840.1" dur="4.35">encrypted or anything so you could</text><text start="1842.08" dur="5.34">definitely expand this you know if you</text><text start="1844.45" dur="5.16">wanted to the other thing too is like</text><text start="1847.42" dur="4.44">you know I can mention it being that</text><text start="1849.61" dur="5.28">that honda diagnostic software is is so</text><text start="1851.86" dur="4.74">hard to use and and slow and a pain to</text><text start="1854.89" dur="4.05">install you can do all kinds of cool</text><text start="1856.6" dur="3.45">stuff with this too right like one of</text><text start="1858.94" dur="2.34">the great things about the honda</text><text start="1860.05" dur="4.26">software is like you can get deep</text><text start="1861.28" dur="5.07">introspection into if you get like check</text><text start="1864.31" dur="3.9">engine lights and so forth what those</text><text start="1866.35" dur="3.39">things you know what are those check</text><text start="1868.21" dur="3.45">engine lights and being able to clear</text><text start="1869.74" dur="3.99">them and so forth so like you can easily</text><text start="1871.66" dur="5.18">you know take this in and for example</text><text start="1873.73" dur="6.66">build your own hds that enabled you to</text><text start="1876.84" dur="5.14">you know more easily maybe clear check</text><text start="1880.39" dur="2.73">engine codes from a web browser so</text><text start="1881.98" dur="2.66">there&amp;#39;s all kinds of cool stuff you can</text><text start="1883.12" dur="3.53">do with this</text><text start="1884.64" dur="3.78">so let me power this it&amp;#39;s powered on</text><text start="1886.65" dur="3.39">here I don&amp;#39;t know if anyone can really</text><text start="1888.42" dur="2.1">see this here sorry we didn&amp;#39;t get a</text><text start="1890.04" dur="4.34">table</text><text start="1890.52" dur="6.06">so this chair here is my what&amp;#39;s that oh</text><text start="1894.38" dur="5.1">hey I got a table I&amp;#39;m gonna go grab the</text><text start="1896.58" dur="2.9">table quick thanks</text><text start="1931.23" dur="3.27">all right so this may be the step</text><text start="1933.029" dur="3.181">deserves a little more explanation here</text><text start="1934.5" dur="3.12">so this doesn&amp;#39;t really look like</text><text start="1936.21" dur="3">electronic power steering this because</text><text start="1937.62" dur="5">it&amp;#39;s like all tore apart and like the</text><text start="1939.21" dur="5.79">controller in this situation is not</text><text start="1942.62" dur="4.45">separate from the motor they actually</text><text start="1945" dur="3.809">put the controller in the motor so</text><text start="1947.07" dur="5.489">that&amp;#39;s why it&amp;#39;s like all tore apart and</text><text start="1948.809" dur="9.931">weird I&amp;#39;m using one of those panda obd2</text><text start="1952.559" dur="7.561">dongles that comment I sells and the red</text><text start="1958.74" dur="3.929">thing plugged in is just so that I have</text><text start="1960.12" dur="4.23">a long USB a long enough USB cord that&amp;#39;s</text><text start="1962.669" dur="5.341">called a panda paw it&amp;#39;s just in case</text><text start="1964.35" dur="5.429">like you brick your your obd2 dongle you</text><text start="1968.01" dur="3.659">can actually you actually can&amp;#39;t really</text><text start="1969.779" dur="5.061">brick it because you can use this panda</text><text start="1971.669" dur="5.97">pod to get it in Adi a few boot mode so</text><text start="1974.84" dur="4.569">that&amp;#39;s plugged into another thing that</text><text start="1977.639" dur="4.26">we sell which you don&amp;#39;t need by any</text><text start="1979.409" dur="4.37">means at all it&amp;#39;s just it&amp;#39;s just like a</text><text start="1981.899" dur="6.451">development board that breaks out the</text><text start="1983.779" dur="7.39">the obd2 pins really conveniently so I</text><text start="1988.35" dur="5.61">just use that to build an adapter to go</text><text start="1991.169" dur="8.581">from the ECU from like the real ECU</text><text start="1993.96" dur="8.64">connector to the Panda PO db2 connector</text><text start="1999.75" dur="10.649">so advice</text><text start="2002.6" dur="10.919">so yeah so all right let&amp;#39;s pull up this</text><text start="2010.399" dur="5.37">is my fake firmware update that is just</text><text start="2013.519" dur="4.65">like the stock firmware that I generated</text><text start="2015.769" dur="5.671">a file for because there is no firmware</text><text start="2018.169" dur="7.711">update for this ECU I picked that from R</text><text start="2021.44" dur="5.969">update file and I say next now this is</text><text start="2025.88" dur="5.669">where those headers that are in the RWD</text><text start="2027.409" dur="7.821">file come into play it just it just went</text><text start="2031.549" dur="6.24">out and so I implemented that UDS</text><text start="2035.23" dur="4.96">protocol and the is OTP I am I</text><text start="2037.789" dur="4.561">implemented in JavaScript you can see it</text><text start="2040.19" dur="5.55">in one of my in the github repo for this</text><text start="2042.35" dur="6.239">for this website so like it just went</text><text start="2045.74" dur="7.53">off and it just worried that can address</text><text start="2048.589" dur="7.03">180 a 3-0 F 1 and I think it might have</text><text start="2053.27" dur="5.259">sound like tester present</text><text start="2055.619" dur="5.01">or something like that I know I&amp;#39;m sorry</text><text start="2058.529" dur="4.681">they didn&amp;#39;t send it off yet we start to</text><text start="2060.629" dur="4.98">connect to the ECU</text><text start="2063.21" dur="6.929">so the way web USB works for like</text><text start="2065.609" dur="6.661">security reasons is if you have a device</text><text start="2070.139" dur="3.54">implements the web USB protocol when you</text><text start="2072.27" dur="4.26">plug into your computer it doesn&amp;#39;t just</text><text start="2073.679" dur="5.94">like get access to things so Chrome has</text><text start="2076.53" dur="5.97">this specification where there&amp;#39;s there&amp;#39;s</text><text start="2079.619" dur="5.461">a JavaScript call you can make to say go</text><text start="2082.5" dur="6.929">you know go talk to this USB device and</text><text start="2085.08" dur="7.62">then it prompts the user to actually say</text><text start="2089.429" dur="6.381">yes you&amp;#39;re allowed to talk to this USB</text><text start="2092.7" dur="3.11">device from a web browser</text><text start="2096.71" dur="5.609">so I pick it I say connect okay now now</text><text start="2100.579" dur="5.131">it actually went out and it actually</text><text start="2102.319" dur="6.481">like sound like tester present to the</text><text start="2105.71" dur="3.629">ECU and said like are you there are you</text><text start="2108.8" dur="3.72">awake</text><text start="2109.339" dur="4.141">and then there&amp;#39;s another UDS message</text><text start="2112.52" dur="4.92">called</text><text start="2113.48" dur="6.06">like read memory by address I think it&amp;#39;s</text><text start="2117.44" dur="4.74">read memory by address and there&amp;#39;s a</text><text start="2119.54" dur="4.319">specific code that&amp;#39;s defined that</text><text start="2122.18" dur="3.899">there&amp;#39;s like four of them they&amp;#39;re like</text><text start="2123.859" dur="4.801">loader versions software version</text><text start="2126.079" dur="4.891">application version so I think it&amp;#39;s I</text><text start="2128.66" dur="4.29">think it&amp;#39;s software version it goes off</text><text start="2130.97" dur="4.47">and it queries the software version and</text><text start="2132.95" dur="7.169">it checks does the software version that</text><text start="2135.44" dur="8.31">the ECU returned match what my RWD</text><text start="2140.119" dur="6.24">headers excuse me what my RWD headers</text><text start="2143.75" dur="6.359">say are the supported software versions</text><text start="2146.359" dur="8.851">for this for a more update file alright</text><text start="2150.109" dur="6.45">so now we&amp;#39;re connected next okay this is</text><text start="2155.21" dur="3.09">the danger screen like I said you can</text><text start="2156.559" dur="3">brick an ECU so don&amp;#39;t do this with an</text><text start="2158.3" dur="4.23">ECU that you&amp;#39;re not willing to pay to</text><text start="2159.559" dur="8.27">replace something could go wrong I say I</text><text start="2162.53" dur="9.299">agree and flash it&amp;#39;s erasing the memory</text><text start="2167.829" dur="4.961">and now it&amp;#39;s flashing the firmware so</text><text start="2171.829" dur="2.22">it&amp;#39;s basically just going to that</text><text start="2172.79" dur="4.11">sequence they laid out at the very</text><text start="2174.049" dur="5.641">beginning to actually send the firmware</text><text start="2176.9" dur="4.53">update so you can can&amp;#39;t really see the</text><text start="2179.69" dur="6.649">progress bar there really well but it&amp;#39;s</text><text start="2181.43" dur="4.909">like 25 percent and moving along</text><text start="2187.2" dur="6.02">LEDs are like flashing different colors</text><text start="2189.27" dur="3.95">on the table over here</text><text start="2195.96" dur="6.52">yeah so I know once you have this I</text><text start="2201.04" dur="3.62">guess flashing a firmware updates pretty</text><text start="2202.48" dur="2.18">boring</text><text start="2207.23" dur="6.359">it&amp;#39;ll be done here in a second a few</text><text start="2210.2" dur="5.43">seconds about 80% and then I&amp;#39;ll just</text><text start="2213.589" dur="5.121">pull something up like this ECU just</text><text start="2215.63" dur="7.5">constantly dumps out some messages on</text><text start="2218.71" dur="6.97">the canvas okay it&amp;#39;s complete so all</text><text start="2223.13" dur="4.469">right let&amp;#39;s talk to this ECU I got to</text><text start="2225.68" dur="5.04">free up the USB device the web browser</text><text start="2227.599" dur="4.861">doesn&amp;#39;t have a hold of it and all right</text><text start="2230.72" dur="3.839">so let&amp;#39;s see if this all right so it</text><text start="2232.46" dur="3.33">should be now if I didn&amp;#39;t hopefully this</text><text start="2234.559" dur="3.871">is where like the live demo doesn&amp;#39;t go</text><text start="2235.79" dur="4.89">all wrong if I try to connect to this</text><text start="2238.43" dur="5.21">ECU and read all the messages that it&amp;#39;s</text><text start="2240.68" dur="2.96">dumping out on the canvas</text><text start="2244.069" dur="6.621">there you go so it&amp;#39;s like five messages</text><text start="2248.599" dur="4.5">that just dumps out I think it&amp;#39;s like a</text><text start="2250.69" dur="4.72">torque sensor that&amp;#39;s on it and a bunch</text><text start="2253.099" dur="6.031">of other stuff so</text><text start="2255.41" dur="13.909">so yeah and I guess that&amp;#39;s it that&amp;#39;s my</text><text start="2259.13" dur="10.189">talk what&amp;#39;s up</text><text start="2286.96" dur="3.139">[Applause]</text><text start="2305.119" dur="2.031">I</text><text start="2318.66" dur="5.129">yeah sure so is there any signature on</text><text start="2321.63" dur="5.129">the firmware no yeah there&amp;#39;s no</text><text start="2323.789" dur="4.851">signature it just like they just there&amp;#39;s</text><text start="2326.759" dur="4.981">there&amp;#39;s that last step where they say</text><text start="2328.64" dur="4.81">they say basically validate the firmware</text><text start="2331.74" dur="3.569">there&amp;#39;s like a routine control message</text><text start="2333.45" dur="3.659">that gets called and that validation is</text><text start="2335.309" dur="4.621">just our that check do the checks that</text><text start="2337.109" dur="4.801">do the do the do this some of the bytes</text><text start="2339.93" dur="3.81">add up so yeah so yeah there&amp;#39;s nothing</text><text start="2341.91" dur="3.57">like that did it and then the other</text><text start="2343.74" dur="4.349">comment was I made some assumptions</text><text start="2345.48" dur="4.92">about like I had something I wanted to</text><text start="2348.089" dur="5.73">decrypt it and I didn&amp;#39;t know you know</text><text start="2350.4" dur="4.619">what the how I would do I know like how</text><text start="2353.819" dur="3.361">would I make those assumptions so that I</text><text start="2355.019" dur="5.25">know when it was decrypted completely or</text><text start="2357.18" dur="6.3">properly yeah so I mean I just guessed</text><text start="2360.269" dur="5.881">right and then in addition to guessing</text><text start="2363.48" dur="5.67">though this ECU here is tore apart</text><text start="2366.15" dur="5.58">because then I have the decrypted</text><text start="2369.15" dur="5.01">firmware like I figured out how to dump</text><text start="2371.73" dur="4.65">the full firmware so so like these</text><text start="2374.16" dur="4.379">firmware update files they&amp;#39;re you know</text><text start="2376.38" dur="4.429">potentially not super useful to modify</text><text start="2378.539" dur="4.461">because they&amp;#39;re partial right like</text><text start="2380.809" dur="4.72">important things that you want to modify</text><text start="2383" dur="4.509">or you need to like reverse engineering</text><text start="2385.529" dur="5.881">out of them they might not even be in</text><text start="2387.509" dur="6.78">the update section right so like what I</text><text start="2391.41" dur="5.639">did was I got an ECU that I was able to</text><text start="2394.289" dur="5.01">dump the firmware off of and then I just</text><text start="2397.049" dur="4.111">had these ideas like okay well I should</text><text start="2399.299" dur="4.621">be able to find this software version</text><text start="2401.16" dur="6.179">that you can request through read memory</text><text start="2403.92" dur="5.129">by address and maybe it&amp;#39;s like I just</text><text start="2407.339" dur="4.26">tried like okay well maybe how many</text><text start="2409.049" dur="5.151">times I had no idea how many times how</text><text start="2411.599" dur="4.341">many sets of</text><text start="2414.2" dur="4.169">you know combinations of operators and</text><text start="2415.94" dur="5.01">my brute-force decryption would match</text><text start="2418.369" dur="5.941">and it turned out like 99% of the time</text><text start="2420.95" dur="6">there was only one and I had the real</text><text start="2424.31" dur="4.769">firmware from an ECU to compare to to</text><text start="2426.95" dur="4.86">then make a hundred percent certain that</text><text start="2429.079" dur="5.481">at least sometimes I was decrypting it</text><text start="2431.81" dur="2.75">successfully</text><text start="2435.65" dur="4.92">this one actually this specific ECU is</text><text start="2438.47" dur="4.41">simpler than that it&amp;#39;s it&amp;#39;s UART its</text><text start="2440.57" dur="3.9">serial but a lot of them are JTAG that</text><text start="2442.88" dur="5.06">you you have to dump them too</text><text start="2444.47" dur="3.47">yep yeah</text><text start="2453.54" dur="3.03">no I don&amp;#39;t think so I mean they don&amp;#39;t</text><text start="2455.34" dur="3.03">they don&amp;#39;t they don&amp;#39;t publish any</text><text start="2456.57" dur="4.05">firmware updates I think George is like</text><text start="2458.37" dur="5.15">set on our discord multiple times at all</text><text start="2460.62" dur="6.3">for more modifications or cancelled so</text><text start="2463.52" dur="4.69">yeah I mean this is just you know this</text><text start="2466.92" dur="4.35">is just me working on this stuff in my</text><text start="2468.21" dur="7.07">free time basically so yeah this is just</text><text start="2471.27" dur="4.01">my stuff for fun so yeah</text><text start="2483.45" dur="4.05">yeah so I haven&amp;#39;t had that much time to</text><text start="2485.91" dur="4.47">like really work on it and make it</text><text start="2487.5" dur="4.77">awesome so like I just tried it on a few</text><text start="2490.38" dur="3.57">ECU&amp;#39;s that are actually in my car but I</text><text start="2492.27" dur="4.38">haven&amp;#39;t like I haven&amp;#39;t specifically</text><text start="2493.95" dur="5.07">tested it out on like what like the</text><text start="2496.65" dur="5.55">engine tuning PC you guys do you know</text><text start="2499.02" dur="4.65">the where there&amp;#39;s a lot more potential I</text><text start="2502.2" dur="3.33">mean they all charge money for that</text><text start="2503.67" dur="3.36">stuff right well metals and I think</text><text start="2505.53" dur="4.62">there&amp;#39;s some free ones like ROM Raider</text><text start="2507.03" dur="5.549">or something like that but like I I</text><text start="2510.15" dur="3.959">think this is the future I think you</text><text start="2512.579" dur="4.441">know it seems like what browsers are</text><text start="2514.109" dur="4.321">gonna be the you know the platform for</text><text start="2517.02" dur="3.63">building modern applications in the</text><text start="2518.43" dur="3.48">future and and so like I don&amp;#39;t I feel</text><text start="2520.65" dur="2.459">like I&amp;#39;m showing you the future of what</text><text start="2521.91" dur="3.649">these tools are going to look like</text><text start="2523.109" dur="2.45">someday</text><text start="2526.779" dur="6.561">all right</text><text start="2528.75" dur="7.47">cool thanks guys and I think someone</text><text start="2533.34" dur="4.74">gave me this adapter thanks a lot for um</text><text start="2536.22" dur="4.49">the adapter so I could actually give my</text><text start="2538.08" dur="2.63">presentation</text><text start="2542.29" dur="2.74">[Applause]</text></transcript>